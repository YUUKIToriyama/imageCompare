{
  "version": 3,
  "sources": ["/home/runner/work/imageCompare/imageCompare/src/components/PreviewImage.jsx"],
  "sourcesContent": ["/* PreviewImage.jsx */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n// Leaflet\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\n\n/*\nimport markerIcon from \"leaflet/dist/images/marker-icon.png\";\nconst defaultIcon = L.icon({\n\ticonUrl: markerIcon,\n\ticonSize: [25, 35],\n});\n*/\n\nclass PreviewImage extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.mapRef = React.createRef();\n\t\tthis.map = null;\n\t\tthis.layer = null;\n\t\tthis.imageBounds;\n\t\tthis.markers = [];\n\t}\n\n\tcomponentDidMount() {\n\t\tlet image = this.props.image;\n\t\tthis.imageBounds = new L.latLngBounds([\n\t\t\t[-image.height / 2, -image.width / 2],\n\t\t\t[image.height / 2, image.width / 2],\n\t\t]);\n\n\t\tthis.map = L.map(this.mapRef.current, {\n\t\t\tcenter: [0, 0],\n\t\t\tmaxBounds: this.imageBounds.pad(0.3),\n\t\t\tcrs: L.CRS.Simple,\n\t\t});\n\t\tthis.layer = L.imageOverlay(image.base64, this.imageBounds);\n\t\tthis.layer.addTo(this.map);\n\t\tthis.map.fitBounds(this.imageBounds);\n\n\t\t// \u30DE\u30FC\u30AB\u30FC\u3092\u8A2D\u7F6E\n\t\t// \u3053\u308C\u3092\u52D5\u304B\u3057\u3066\u4F4D\u7F6E\u5408\u308F\u305B\u3092\u3059\u308B\n\t\tfor (var i = 0; i < this.props.n_marker; i++) {\n\t\t\tlet divIcon = L.divIcon({\n\t\t\t\thtml: `<div class=\"bg-round\"><span>${this.props.n_marker - i}</span></div>`,\n\t\t\t\tclassName: 'divicon',\n\t\t\t});\n\t\t\tlet { lat, lng } = this.map.getCenter();\n\t\t\tlat = lat + 50 * Math.cos((2 * (i + 1) * Math.PI) / this.props.n_marker);\n\t\t\tlng = lng + 50 * Math.sin((2 * (i + 1) * Math.PI) / this.props.n_marker);\n\t\t\tlet marker = new L.marker([lat, lng], {\n\t\t\t\tdraggable: true,\n\t\t\t\ticon: divIcon,\n\t\t\t});\n\t\t\tthis.markers.push(marker);\n\t\t}\n\n\t\tconst setCorrespondingPoints = () => {\n\t\t\tlet correspondingPoint = this.markers.map((marker) => {\n\t\t\t\tlet latlng = marker.getLatLng();\n\t\t\t\t// CRS.Simple\u304B\u3089\u901A\u5E38\u306E\u539F\u70B9\u5EA7\u6A19\u7CFB\u3078\u5909\u63DB\u3057\u3066\u3044\u308B\n\t\t\t\tlet point = {\n\t\t\t\t\tx: this.props.image.width / 2 + latlng.lng,\n\t\t\t\t\ty: this.props.image.height / 2 - latlng.lat,\n\t\t\t\t};\n\t\t\t\treturn point;\n\t\t\t});\n\t\t\tthis.props.onPointsSet(correspondingPoint, this.props.imageId);\n\t\t};\n\t\tsetCorrespondingPoints();\n\t\tthis.markers.forEach((marker) => {\n\t\t\tmarker.on('moveend', (event) => {\n\t\t\t\t//let position = event.target.getLatLng();\n\t\t\t\t//console.log(position);\n\t\t\t\tsetCorrespondingPoints();\n\t\t\t});\n\t\t\tmarker.addTo(this.map);\n\t\t});\n\t}\n\n\trender() {\n\t\treturn <div ref={this.mapRef} style={{ width: this.props.style.width, height: '80vh', float: this.props.style.float }}></div>;\n\t}\n}\n\nPreviewImage.propTypes = {\n\timage: PropTypes.object.isRequired,\n\timageId: PropTypes.number.isRequired,\n\tstyle: PropTypes.object\n};\nPreviewImage.defaultProps = {\n\tstyle: {\"width\": \"50%\", height: \"80vh\", float: \"none\"}\n};\n\nexport default PreviewImage;"],
  "mappings": "AAEA;AACA;AAGA;AACA;AAUA,2BAA2B,MAAM,UAAU;AAAA,EAC1C,YAAY,OAAO;AAClB,UAAM;AACN,SAAK,SAAS,MAAM;AACpB,SAAK,MAAM;AACX,SAAK,QAAQ;AACb,SAAK;AACL,SAAK,UAAU;AAAA;AAAA,EAGhB,oBAAoB;AACnB,QAAI,QAAQ,KAAK,MAAM;AACvB,SAAK,cAAc,IAAI,EAAE,aAAa;AAAA,MACrC,CAAC,CAAC,MAAM,SAAS,GAAG,CAAC,MAAM,QAAQ;AAAA,MACnC,CAAC,MAAM,SAAS,GAAG,MAAM,QAAQ;AAAA;AAGlC,SAAK,MAAM,EAAE,IAAI,KAAK,OAAO,SAAS;AAAA,MACrC,QAAQ,CAAC,GAAG;AAAA,MACZ,WAAW,KAAK,YAAY,IAAI;AAAA,MAChC,KAAK,EAAE,IAAI;AAAA;AAEZ,SAAK,QAAQ,EAAE,aAAa,MAAM,QAAQ,KAAK;AAC/C,SAAK,MAAM,MAAM,KAAK;AACtB,SAAK,IAAI,UAAU,KAAK;AAIxB,aAAS,IAAI,GAAG,IAAI,KAAK,MAAM,UAAU,KAAK;AAC7C,UAAI,UAAU,EAAE,QAAQ;AAAA,QACvB,MAAM,+BAA+B,KAAK,MAAM,WAAW;AAAA,QAC3D,WAAW;AAAA;AAEZ,UAAI,CAAE,KAAK,OAAQ,KAAK,IAAI;AAC5B,YAAM,MAAM,KAAK,KAAK,IAAK,IAAK,KAAI,KAAK,KAAK,KAAM,KAAK,MAAM;AAC/D,YAAM,MAAM,KAAK,KAAK,IAAK,IAAK,KAAI,KAAK,KAAK,KAAM,KAAK,MAAM;AAC/D,UAAI,SAAS,IAAI,EAAE,OAAO,CAAC,KAAK,MAAM;AAAA,QACrC,WAAW;AAAA,QACX,MAAM;AAAA;AAEP,WAAK,QAAQ,KAAK;AAAA;AAGnB,UAAM,yBAAyB,MAAM;AACpC,UAAI,qBAAqB,KAAK,QAAQ,IAAI,CAAC,WAAW;AACrD,YAAI,SAAS,OAAO;AAEpB,YAAI,QAAQ;AAAA,UACX,GAAG,KAAK,MAAM,MAAM,QAAQ,IAAI,OAAO;AAAA,UACvC,GAAG,KAAK,MAAM,MAAM,SAAS,IAAI,OAAO;AAAA;AAEzC,eAAO;AAAA;AAER,WAAK,MAAM,YAAY,oBAAoB,KAAK,MAAM;AAAA;AAEvD;AACA,SAAK,QAAQ,QAAQ,CAAC,WAAW;AAChC,aAAO,GAAG,WAAW,CAAC,UAAU;AAG/B;AAAA;AAED,aAAO,MAAM,KAAK;AAAA;AAAA;AAAA,EAIpB,SAAS;AACR,WAAO,oCAAC,OAAD;AAAA,MAAK,KAAK,KAAK;AAAA,MAAQ,OAAO,CAAE,OAAO,KAAK,MAAM,MAAM,OAAO,QAAQ,QAAQ,OAAO,KAAK,MAAM,MAAM;AAAA;AAAA;AAAA;AAIhH,aAAa,YAAY;AAAA,EACxB,OAAO,UAAU,OAAO;AAAA,EACxB,SAAS,UAAU,OAAO;AAAA,EAC1B,OAAO,UAAU;AAAA;AAElB,aAAa,eAAe;AAAA,EAC3B,OAAO,CAAC,OAAS,OAAO,QAAQ,QAAQ,OAAO;AAAA;AAGhD,eAAe;",
  "names": []
}
