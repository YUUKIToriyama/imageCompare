{"version":3,"sources":["components/MyDrawer.jsx","components/ScrollDialog.jsx","components/MyAppBar.jsx","components/ImageLoader.jsx","components/PreviewImage.jsx","components/ImageCrop.jsx","components/ImageDisplay.jsx","components/Workflow.jsx","opencv-utils/opencv-utils.js","components/LoadingSpinner.jsx","components/MainContent.jsx","App.jsx","index.js"],"names":["MyDrawer","props","handleDrawerOpen","setState","open","handleDrawerClose","state","bind","classes","this","Drawer","className","drawer","variant","anchor","paper","drawerPaper","drawerHeader","IconButton","onClick","ChevronLeft","Divider","List","Link","href","ListItem","button","ListItemIcon","GitHub","ListItemText","Info","Help","React","Component","withStyles","theme","width","flexShrink","display","alignItems","padding","spacing","mixins","toolbar","justifyContent","ScrollDialog","handleClickOpen","handleClose","descriptionElement","createRef","Button","label","Dialog","onClose","scroll","aria-labelledby","aria-describedby","DialogTitle","id","title","DialogContent","dividers","DialogContentText","ref","tabIndex","content","DialogActions","color","MyAppBar","drawerRef","current","root","AppBar","position","Toolbar","edge","menuButton","aria-label","Typography","message","flexGrow","marginRight","ImageLoader","fileInputCallback","file","imageObject","img","Image","src","base64","onload","height","onInputImageChange","Box","labelText","loaderId","imagePreview","multiple","callbackFunction","console","log","name","buttonComponent","component","PhotoCamera","textFieldComponent","type","accept","PreviewImage","mapRef","map","layer","imageBounds","markers","image","L","latLngBounds","center","maxBounds","pad","crs","CRS","Simple","imageOverlay","addTo","fitBounds","i","n_marker","divIcon","html","getCenter","lat","lng","Math","cos","PI","sin","marker","draggable","icon","push","setCorrespondingPoints","correspondingPoint","latlng","getLatLng","x","y","onPointsSet","imageId","forEach","on","event","style","ImageCrop","images","correspondingPointsArray","invisibleCanvasRef","correspondingPoints","array","image_1","image_2","correspondingPoints_1","hash","flat","correspondingPoints_2","createImgElement","dataUrl","imgElement","new_image_1","srcA","srcB","cPointsA","cPointsB","n_points","H","matrixA","cv","matFromArray","CV_32F","matrixB","method","Mat","findHomography","dst","zeros","rows","cols","CV_8UC3","warpPerspective","Size","INTER_LINEAR","BORDER_CONSTANT","Scalar","delete","warpImage","imread","imshow","toDataURL","onImageProcessingDone","ImageDisplay","zoom","GuideButtons","disabled","activeStep","handleBack","isAllowedToStepForward","handleNext","steps","length","Workflow","renderImageLoader","inputImages","executeImageMatching","imageCropRef","handleImageProcessingDone","imageURL","processedImage","processing","prevState","handleReset","getEachSteps","step","StepContent","every","inputImage","CircularProgress","Stepper","orientation","index","Step","StepLabel","Paper","square","elevation","resetContainer","marginTop","actionsContainer","marginBottom","opencvUtils","OPENCV_URL","onloadCallback","script","document","createElement","setAttribute","addEventListener","getBuildInformation","error","querySelector","appendChild","url","callback","crossOrigin","IMREAD_COLOR","SCRIPT_URL","LoadingSpinner","opencvLoaded","Icon","fontSize","split","line","propsTypes","PropTypes","bool","isRequired","defaultProps","MainContent","loadOpenCV","createMuiTheme","palette","primary","orange","typography","fontFamily","join","h1","h2","h3","h4","h5","h6","App","ThemeProvider","CssBaseline","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.9a15d47c.chunk.js","sourcesContent":["/* MyDrawer.jsx */\n\nimport React from 'react';\nimport withStyles from '@material-ui/core/styles/withStyles';\n\nimport {\n\tLink,\n\tDrawer,\n\tDivider,\n\tList,\n\tListItem,\n\tListItemIcon,\n\tListItemText,\n\tIconButton,\n} from '@material-ui/core';\nimport { ChevronLeft, Help, GitHub, Info } from '@material-ui/icons';\n\nconst drawerWidth = 240;\n\nconst useStyles = (theme) => ({\n\tdrawer: {\n\t\twidth: drawerWidth,\n\t\tflexShrink: 0,\n\t},\n\tdrawerPaper: {\n\t\twidth: drawerWidth,\n\t},\n\tdrawerHeader: {\n\t\tdisplay: 'flex',\n\t\talignItems: 'center',\n\t\tpadding: theme.spacing(0, 1),\n\t\t// necessary for content to be below app bar\n\t\t...theme.mixins.toolbar,\n\t\tjustifyContent: 'flex-end',\n\t},\n});\nclass MyDrawer extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\topen: false,\n\t\t};\n\t\t//classes = this.props;\n\t\tthis.handleDrawerClose.bind(this);\n\t\tthis.handleDrawerOpen.bind(this);\n\t}\n\n\thandleDrawerOpen = () => {\n\t\tthis.setState({\n\t\t\topen: true,\n\t\t});\n\t};\n\thandleDrawerClose = () => {\n\t\tthis.setState({\n\t\t\topen: false,\n\t\t});\n\t};\n\trender() {\n\t\tconst { classes } = this.props;\n\t\treturn (\n\t\t\t<Drawer\n\t\t\t\tclassName={classes.drawer}\n\t\t\t\tvariant='persistent'\n\t\t\t\tanchor='left'\n\t\t\t\topen={this.state.open}\n\t\t\t\tclasses={{\n\t\t\t\t\tpaper: classes.drawerPaper,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div className={classes.drawerHeader}>\n\t\t\t\t\t<IconButton onClick={this.handleDrawerClose}>\n\t\t\t\t\t\t<ChevronLeft />\n\t\t\t\t\t</IconButton>\n\t\t\t\t</div>\n\t\t\t\t<Divider />\n\t\t\t\t<List>\n\t\t\t\t\t<Link href='https://github.com/YUUKIToriyama/imageCompare'>\n\t\t\t\t\t\t<ListItem button key='Github'>\n\t\t\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t\t\t<GitHub />\n\t\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t\t<ListItemText>View Source Code</ListItemText>\n\t\t\t\t\t\t</ListItem>\n\t\t\t\t\t</Link>\n\t\t\t\t\t<ListItem button key='Information'>\n\t\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t\t<Info />\n\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t<ListItemText>More information</ListItemText>\n\t\t\t\t\t</ListItem>\n\t\t\t\t\t<ListItem button key='Help'>\n\t\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t\t<Help />\n\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t<ListItemText>Show Help</ListItemText>\n\t\t\t\t\t</ListItem>\n\t\t\t\t</List>\n\t\t\t</Drawer>\n\t\t);\n\t}\n}\n\nexport default withStyles(useStyles)(MyDrawer);\n","/* ScrollDialog.jsx */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {\n\tButton,\n\tDialog,\n\tDialogActions,\n\tDialogContent,\n\tDialogContentText,\n\tDialogTitle,\n} from '@material-ui/core';\n\nclass ScrollDialog extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\topen: false,\n\t\t};\n\t\tthis.descriptionElement = React.createRef();\n\t}\n\n\thandleClickOpen = () => {\n\t\tthis.setState({\n\t\t\topen: true,\n\t\t});\n\t};\n\n\thandleClose = () => {\n\t\tthis.setState({\n\t\t\topen: false,\n\t\t});\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Button onClick={this.handleClickOpen}>{this.props.label}</Button>\n\t\t\t\t<Dialog\n\t\t\t\t\topen={this.state.open}\n\t\t\t\t\tonClose={this.handleClose}\n\t\t\t\t\tscroll='paper'\n\t\t\t\t\taria-labelledby='scroll-dialog-title'\n\t\t\t\t\taria-describedby='scroll-dialog-description'\n\t\t\t\t>\n\t\t\t\t\t<DialogTitle id='scroll-dialog-title'>{this.props.title}</DialogTitle>\n\t\t\t\t\t<DialogContent dividers={true}>\n\t\t\t\t\t\t<DialogContentText\n\t\t\t\t\t\t\tid='scroll-dialog-description'\n\t\t\t\t\t\t\tref={this.descriptionElement}\n\t\t\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{this.props.content}\n\t\t\t\t\t\t</DialogContentText>\n\t\t\t\t\t</DialogContent>\n\t\t\t\t\t<DialogActions>\n\t\t\t\t\t\t<Button onClick={this.handleClose} color='primary'>\n\t\t\t\t\t\t\tOK\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogActions>\n\t\t\t\t</Dialog>\n\t\t\t</div>\n\t\t);\n\t}\n}\nexport default ScrollDialog;\n\nScrollDialog.propTypes = {\n\tlabel: PropTypes.string,\n\ttitle: PropTypes.string,\n\tcontent: PropTypes.any,\n};\n","/* MyAppBar.jsx */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport { AppBar, Toolbar, Typography, IconButton } from '@material-ui/core';\nimport MenuIcon from '@material-ui/icons/Menu';\n\n// 自作モジュールの読み込み\nimport MyDrawer from './MyDrawer';\nimport ScrollDialog from './ScrollDialog';\n\nconst useStyles = (theme) => ({\n\troot: {\n\t\tflexGrow: 1,\n\t},\n\tmenuButton: {\n\t\tmarginRight: theme.spacing(2),\n\t},\n\ttitle: {\n\t\tflexGrow: 1,\n\t},\n});\n\nclass MyAppBar extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.drawerRef = React.createRef();\n\t}\n\n\thandleDrawerOpen = () => {\n\t\tthis.drawerRef.current.handleDrawerOpen();\n\t};\n\n\trender() {\n\t\tconst { classes } = this.props;\n\t\treturn (\n\t\t\t<div className={classes.root}>\n\t\t\t\t<AppBar position='static'>\n\t\t\t\t\t<Toolbar>\n\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\tedge='start'\n\t\t\t\t\t\t\tclassName={classes.menuButton}\n\t\t\t\t\t\t\tcolor='inherit'\n\t\t\t\t\t\t\taria-label='menu'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<MenuIcon onClick={this.handleDrawerOpen} />\n\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t<Typography variant='h6' className={classes.title}>\n\t\t\t\t\t\t\t{this.props.title}\n\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t<ScrollDialog\n\t\t\t\t\t\t\tlabel='Help'\n\t\t\t\t\t\t\ttitle='About this app'\n\t\t\t\t\t\t\tcontent={this.props.message}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Toolbar>\n\t\t\t\t</AppBar>\n\t\t\t\t<MyDrawer ref={this.drawerRef} />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default withStyles(useStyles)(MyAppBar);\n\nMyAppBar.propTypes = {\n\tmessage: PropTypes.string,\n\ttitle: PropTypes.string.isRequired,\n};\n","/* ImageLoader.jsx */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Box, IconButton } from '@material-ui/core';\nimport { PhotoCamera } from '@material-ui/icons';\nimport FileInputComponent from 'react-file-input-previews-base64';\n\nclass ImageLoader extends React.Component {\n\tfileInputCallback = (file) => {\n\t\tlet imageObject = file;\n\t\tlet img = new Image();\n\t\timg.src = imageObject.base64;\n\t\timg.onload = () => {\n\t\t\timageObject['width'] = img.width;\n\t\t\timageObject['height'] = img.height;\n\t\t\t// 親コンポーネントに読み込んだ画像を登録\n\t\t\tthis.props.onInputImageChange(imageObject);\n\t\t};\n\t\t/* imageObjectには以下のようなオブジェクトが入ります\n\t\t{\n\t\t\tname: 'IMG_20160813_102226.jpg',\n\t\t\ttype: 'image/jpeg',\n\t\t\tsize: 645,\n\t\t\tbase64: 'data:image/jpeg;base64,/9j/4SzyRXhpZgAATU0AKgA...',\n\t\t\tfile: File,\n\t\t\twidth: 320,\n\t\t\theight: 260\n\t\t};\n\t\t*/\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<Box>\n\t\t\t\t<FileInputComponent\n\t\t\t\t\tlabelText={this.props.loaderId + 1 + '枚目'}\n\t\t\t\t\timagePreview={true}\n\t\t\t\t\tmultiple={false}\n\t\t\t\t\tcallbackFunction={(file) => {\n\t\t\t\t\t\tconsole.log(file.name + ' has been loaded.');\n\t\t\t\t\t\tthis.fileInputCallback(file);\n\t\t\t\t\t}}\n\t\t\t\t\tbuttonComponent={\n\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\tcolor='primary'\n\t\t\t\t\t\t\taria-label='upload picture'\n\t\t\t\t\t\t\tcomponent='span'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<PhotoCamera />\n\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t}\n\t\t\t\t\ttextFieldComponent={<input type='text' />}\n\t\t\t\t\taccept='image/*'\n\t\t\t\t/>\n\t\t\t</Box>\n\t\t);\n\t}\n}\nexport default ImageLoader;\n\nImageLoader.propTypes = {\n\tloaderId: PropTypes.number.isRequired,\n\tonInputImageChange: PropTypes.func.isRequired,\n};\n","/* PreviewImage.jsx */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\n// Leaflet\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\n\n/*\nimport markerIcon from \"leaflet/dist/images/marker-icon.png\";\nconst defaultIcon = L.icon({\n\ticonUrl: markerIcon,\n\ticonSize: [25, 35],\n});\n*/\n\nclass PreviewImage extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.mapRef = React.createRef();\n\t\tthis.map = null;\n\t\tthis.layer = null;\n\t\tthis.imageBounds;\n\t\tthis.markers = [];\n\t}\n\n\tcomponentDidMount() {\n\t\tlet image = this.props.image;\n\t\tthis.imageBounds = new L.latLngBounds([\n\t\t\t[-image.height / 2, -image.width / 2],\n\t\t\t[image.height / 2, image.width / 2],\n\t\t]);\n\n\t\tthis.map = L.map(this.mapRef.current, {\n\t\t\tcenter: [0, 0],\n\t\t\tmaxBounds: this.imageBounds.pad(0.3),\n\t\t\tcrs: L.CRS.Simple,\n\t\t});\n\t\tthis.layer = L.imageOverlay(image.base64, this.imageBounds);\n\t\tthis.layer.addTo(this.map);\n\t\tthis.map.fitBounds(this.imageBounds);\n\n\t\t// マーカーを設置\n\t\t// これを動かして位置合わせをする\n\t\tfor (var i = 0; i < this.props.n_marker; i++) {\n\t\t\tlet divIcon = L.divIcon({\n\t\t\t\thtml: `<div class=\"bg-round\"><span>${this.props.n_marker - i}</span></div>`,\n\t\t\t\tclassName: 'divicon',\n\t\t\t});\n\t\t\tlet { lat, lng } = this.map.getCenter();\n\t\t\tlat = lat + 50 * Math.cos((2 * (i + 1) * Math.PI) / this.props.n_marker);\n\t\t\tlng = lng + 50 * Math.sin((2 * (i + 1) * Math.PI) / this.props.n_marker);\n\t\t\tlet marker = new L.marker([lat, lng], {\n\t\t\t\tdraggable: true,\n\t\t\t\ticon: divIcon,\n\t\t\t});\n\t\t\tthis.markers.push(marker);\n\t\t}\n\n\t\tconst setCorrespondingPoints = () => {\n\t\t\tlet correspondingPoint = this.markers.map((marker) => {\n\t\t\t\tlet latlng = marker.getLatLng();\n\t\t\t\t// CRS.Simpleから通常の原点座標系へ変換している\n\t\t\t\tlet point = {\n\t\t\t\t\tx: this.props.image.width / 2 + latlng.lng,\n\t\t\t\t\ty: this.props.image.height / 2 - latlng.lat,\n\t\t\t\t};\n\t\t\t\treturn point;\n\t\t\t});\n\t\t\tthis.props.onPointsSet(correspondingPoint, this.props.imageId);\n\t\t};\n\t\tsetCorrespondingPoints();\n\t\tthis.markers.forEach((marker) => {\n\t\t\tmarker.on('moveend', (event) => {\n\t\t\t\t//let position = event.target.getLatLng();\n\t\t\t\t//console.log(position);\n\t\t\t\tsetCorrespondingPoints();\n\t\t\t});\n\t\t\tmarker.addTo(this.map);\n\t\t});\n\t}\n\n\trender() {\n\t\treturn <div ref={this.mapRef} style={{ width: '100%', height: '300px' }}></div>;\n\t}\n}\n\nexport default PreviewImage;\n\nPreviewImage.propTypes = {\n\timage: PropTypes.object.isRequired,\n\timageId: PropTypes.number.isRequired,\n};\n","/* ImageCrop.jsx */\n// canvasを使って画像の位置合わせをするのをやめる\n// その代わりにleafletのピンを用いて位置の特定を行ない、\n// それをもとにopencvで位置合わせを行なう\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Box from '@material-ui/core/Box';\n\n// 自作モジュールの読み込み\n//import opencvUtils from '../opencv-utils/opencv-utils';\nimport PreviewImage from './PreviewImage';\n\nconst warpImage = (srcA, srcB, cPointsA, cPointsB, n_points) => {\n\t// srcA, srcB: 入力画像(cv.Mat)\n\t// cPointsA, cPointsB: 対応点。javascriptの配列\n\t// n_points: 対応点の個数\n\tconst matA = cv.matFromArray(n_points, 3, cv.CV_32F, cPointsA);\n\tconst matB = cv.matFromArray(n_points, 3, cv.CV_32F, cPointsB);\n\n\t// ホモグラフィの推定\n\tconst estimateHomography = (matrixA, matrixB, method) => {\n\t\t// method: 0(default) or 4(LMEDS) or 8(RANSAC) or 16(RHO)\n\t\tlet homography = new cv.Mat(3, 3, cv.CV_32F);\n\t\thomography = cv.findHomography(matrixA, matrixB, method);\n\t\treturn homography;\n\t};\n\n\tlet H = estimateHomography(matA, matB, 0);\n\tlet dst = cv.Mat.zeros(srcB.rows, srcB.cols, cv.CV_8UC3);\n\n\tcv.warpPerspective(srcA, dst, H, new cv.Size(dst.cols, dst.rows), cv.INTER_LINEAR, cv.BORDER_CONSTANT, new cv.Scalar());\n\tsrcA.delete();\n\tsrcB.delete();\n\treturn dst;\n\t//dst.delete();\n};\n\nclass ImageCrop extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.images = this.props.images;\n\t\tthis.state = {\n\t\t\tcorrespondingPointsArray: [null, null],\n\t\t};\n\t\tthis.setCorrespondingPoints = this.setCorrespondingPoints.bind(this);\n\t\tthis.invisibleCanvasRef = React.createRef();\n\t\tthis.n_marker = 4;\n\t}\n\n\tsetCorrespondingPoints(correspondingPoints, id) {\n\t\tlet array = this.state.correspondingPointsArray;\n\t\tarray[id] = correspondingPoints;\n\t\tthis.setState({\n\t\t\tcorrespondingPointsArray: array,\n\t\t});\n\t}\n\n\texecuteImageMatching() {\n\t\t// マーカーの位置情報から対応点の配列を作る\n\t\tconst correspondingPoints_1 = this.state.correspondingPointsArray[0]\n\t\t\t.map((hash) => {\n\t\t\t\treturn [hash.x, hash.y, 1];\n\t\t\t})\n\t\t\t.flat();\n\t\tconst correspondingPoints_2 = this.state.correspondingPointsArray[1]\n\t\t\t.map((hash) => {\n\t\t\t\treturn [hash.x, hash.y, 1];\n\t\t\t})\n\t\t\t.flat();\n\t\t// 画像の読み出し\n\t\tconst createImgElement = (dataUrl) => {\n\t\t\tlet imgElement = new Image();\n\t\t\timgElement.src = dataUrl;\n\t\t\treturn imgElement;\n\t\t};\n\n\t\tlet image_1, image_2;\n\t\timage_1 = cv.imread(createImgElement(this.images[0].base64));\n\t\timage_2 = cv.imread(createImgElement(this.images[1].base64));\n\n\t\t// image_1をimage_2のサイズをもとに変換する\n\t\tlet new_image_1 = warpImage(image_1, image_2, correspondingPoints_1, correspondingPoints_2, this.n_marker);\n\t\t// new_image_1を一旦canvasに貼り、base64に変換する\n\t\tcv.imshow(this.invisibleCanvasRef.current, new_image_1);\n\t\tlet dataUrl = this.invisibleCanvasRef.current.toDataURL('image/png', 1);\n\t\t// Workflowに送る\n\t\tthis.props.onImageProcessingDone(dataUrl);\n\t\timage_1.delete();\n\t\timage_2.delete();\n\t\tnew_image_1.delete();\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Box>\n\t\t\t\t<PreviewImage imageId={0} image={this.images[0]} onPointsSet={this.setCorrespondingPoints} n_marker={this.n_marker} />\n\t\t\t\t<PreviewImage imageId={1} image={this.images[1]} onPointsSet={this.setCorrespondingPoints} n_marker={this.n_marker} />\n\t\t\t\t<canvas ref={this.invisibleCanvasRef} style={{ display: 'none' }}></canvas>\n\t\t\t</Box>\n\t\t);\n\t}\n}\n\nexport default ImageCrop;\n\nImageCrop.propTypes = {\n\timages: PropTypes.array.isRequired,\n\tonImageProcessingDone: PropTypes.func.isRequired,\n};\n","/* ImageDisplay.jsx */\n\nimport React from \"react\";\nimport \"leaflet/dist/leaflet.css\";\n/*\nimport {\n    MapContainer,\n    ImageOverlay,\n    //Marker\n} from \"react-leaflet\";\n*/\nimport L from \"leaflet\";\n/*\nimport markerIcon from \"leaflet/dist/images/marker-icon.png\";\nconst popupIcon = L.icon({\n    iconUrl: markerIcon,\n    iconSize: [25,35]\n});\n*/\n\nclass ImageDisplay extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            lat: 0, \n            lng: 0,\n            zoom: 0,\n            crs: L.CRS.Simple\n        }\n    }\n\n    render() {\n        const image = this.props.image;\n        return (\n            /*\n            <MapContainer center={[this.state.lat, this.state.lng]} zoom={this.state.zoom} crs={this.state.crs} style={{width: \"100%\", height: \"300px\"}}>\n                <ImageOverlay\n                    attribution=\"imageCompare\"\n                    url={image.url}\n                    bounds={L.latLngBounds([-image.width / 2, -image.height / 2], [image.width / 2, image.height / 2])}\n                >\n                </ImageOverlay>\n            </MapContainer>\n            */\n           <div></div>\n        )\n    }\n}\n\nexport default ImageDisplay;","/* Workflow.jsx */\n\nimport React from 'react';\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport { Stepper, Step, StepLabel, StepContent, Button, Box, Paper, Typography } from '@material-ui/core';\n\nimport CircularProgress from '@material-ui/core/CircularProgress';\n// 自作モジュールの読み込み\nimport ImageLoader from './ImageLoader';\nimport ImageCrop from './ImageCrop';\nimport ImageDisplay from './ImageDisplay';\n\nconst styles = {\n\troot: {\n\t\twidth: '100%',\n\t},\n\tbutton: {\n\t\tmarginTop: '15px',\n\t\tmarginRight: '15px',\n\t},\n\tactionsContainer: {\n\t\tmarginBottom: '15px',\n\t},\n\tresetContainer: {\n\t\tpadding: '15px',\n\t},\n};\n\n// ステップごとに「進む」「戻る」ボタンの有効/無効を決めたかったのでWorkflowから分離\nclass GuideButtons extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<Box>\n\t\t\t\t<Button disabled={this.props.activeStep === 0} onClick={this.props.handleBack}>\n\t\t\t\t\tBack\n\t\t\t\t</Button>\n\t\t\t\t<Button disabled={!this.props.isAllowedToStepForward} variant='contained' color='primary' onClick={this.props.handleNext}>\n\t\t\t\t\t{this.props.activeStep === this.props.steps.length - 1 ? 'Finish' : 'Next'}\n\t\t\t\t</Button>\n\t\t\t</Box>\n\t\t);\n\t}\n}\n\nclass Workflow extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\t//this.handleInputImageChange = this.handleInputImageChange.bind(this);\n\t\tthis.state = {\n\t\t\tactiveStep: 0,\n\t\t\t//isAllowedToStepForward: false,\n\t\t\tinputImages: [null, null],\n\t\t\tprocessedImage: '',\n\t\t\tprocessing: false,\n\t\t};\n\t\tthis.imageCropRef = React.createRef();\n\t}\n\n\tsteps = ['画像をアップロード', '対応点を選択', '変換'];\n\n\t// ImageLoaderを複数用意するための準備\n\trenderImageLoader = (i) => {\n\t\treturn (\n\t\t\t<ImageLoader\n\t\t\t\tloaderId={i}\n\t\t\t\tonInputImageChange={(imageObject) => {\n\t\t\t\t\tlet images = this.state.inputImages;\n\t\t\t\t\timages[i] = imageObject;\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tinputImages: images,\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\t};\n\n\t// 画像処理を行なう\n\texecuteImageMatching = () => {\n\t\tthis.imageCropRef.current.executeImageMatching();\n\t};\n\t// 処理の終わった画像を受け取る関数\n\t// ImageCropsから呼び出して使う\n\thandleImageProcessingDone = (imageURL) => {\n\t\tthis.setState({\n\t\t\tprocessedImage: imageURL,\n\t\t\tprocessing: false,\n\t\t});\n\t};\n\n\t// Stepperの挙動を制御する関数\n\thandleNext = () => {\n\t\tthis.setState((prevState) => ({\n\t\t\tactiveStep: prevState.activeStep + 1,\n\t\t}));\n\t};\n\thandleBack = () => {\n\t\tthis.setState((prevState) => ({\n\t\t\tactiveStep: prevState.activeStep - 1,\n\t\t}));\n\t};\n\thandleReset = () => {\n\t\tthis.setState({\n\t\t\tactiveStep: 0,\n\t\t});\n\t};\n\n\tgetEachSteps = (step) => {\n\t\tswitch (step) {\n\t\t\tcase 0:\n\t\t\t\treturn (\n\t\t\t\t\t<StepContent>\n\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t<Typography>処理を行なう画像をアップロード</Typography>\n\t\t\t\t\t\t\t{this.renderImageLoader(0)}\n\t\t\t\t\t\t\t{this.renderImageLoader(1)}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<GuideButtons\n\t\t\t\t\t\t\tactiveStep={this.state.activeStep}\n\t\t\t\t\t\t\thandleBack={this.handleBack}\n\t\t\t\t\t\t\thandleNext={this.handleNext}\n\t\t\t\t\t\t\tisAllowedToStepForward={\n\t\t\t\t\t\t\t\t// 画像が二枚選択されていないと次に進めないようにする\n\t\t\t\t\t\t\t\tthis.state.inputImages.length == 2 &&\n\t\t\t\t\t\t\t\tthis.state.inputImages.every((inputImage) => {\n\t\t\t\t\t\t\t\t\treturn inputImage != null;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsteps={this.steps}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</StepContent>\n\t\t\t\t);\n\t\t\tcase 1:\n\t\t\t\treturn (\n\t\t\t\t\t<StepContent>\n\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t<Typography>マーカーを動かして対応する点を指定してください</Typography>\n\t\t\t\t\t\t\t<ImageCrop ref={this.imageCropRef} images={this.state.inputImages} onImageProcessingDone={this.handleImageProcessingDone} />\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\t\tprocessing: true,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tthis.executeImageMatching();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t開始\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t{this.state.processing == true && <CircularProgress />}\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<GuideButtons activeStep={this.state.activeStep} handleBack={this.handleBack} handleNext={this.handleNext} isAllowedToStepForward={this.state.processedImage != ''} steps={this.steps} />\n\t\t\t\t\t</StepContent>\n\t\t\t\t);\n\t\t\tcase 2:\n\t\t\t\treturn (\n\t\t\t\t\t<StepContent>\n\t\t\t\t\t\t<Box>\n\t\t\t\t\t\t\t<Typography>処理中……</Typography>\n\t\t\t\t\t\t\t<ImageDisplay image={this.state.processedImage} />\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t<GuideButtons activeStep={this.state.activeStep} handleBack={this.handleBack} handleNext={this.handleNext} isAllowedToStepForward={true} steps={this.steps} />\n\t\t\t\t\t</StepContent>\n\t\t\t\t);\n\t\t\tdefault:\n\t\t\t\treturn (\n\t\t\t\t\t<StepContent>\n\t\t\t\t\t\t<Typography>Unknown step</Typography>\n\t\t\t\t\t</StepContent>\n\t\t\t\t);\n\t\t}\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<Box className={this.props.classes.root}>\n\t\t\t\t<Stepper activeStep={this.state.activeStep} orientation='vertical'>\n\t\t\t\t\t{this.steps.map((label, index) => (\n\t\t\t\t\t\t<Step key={label}>\n\t\t\t\t\t\t\t<StepLabel>{label}</StepLabel>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// 各ステップがここに挿入される\n\t\t\t\t\t\t\t\tthis.getEachSteps(index)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</Step>\n\t\t\t\t\t))}\n\t\t\t\t</Stepper>\n\t\t\t\t{this.state.activeStep === this.steps.length && (\n\t\t\t\t\t<Paper square elevation={0} className={this.props.classes.resetContainer}>\n\t\t\t\t\t\t<Typography>処理が完了しました！</Typography>\n\t\t\t\t\t\t<Button onClick={this.handleReset} className={this.props.classes.button}>\n\t\t\t\t\t\t\tやり直す\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Paper>\n\t\t\t\t)}\n\t\t\t</Box>\n\t\t);\n\t}\n}\n\nexport default withStyles(styles)(Workflow);\n","/* opencv-utils.js \n *\n * Overview\n * OpenCV.jsを使用する際、そのファイルの読み込みの順番やスクリプトの実行のタイミングを考慮しながらプログラムを書くのが難しい。\n * そこで、OpenCV.jsを読み込み安全に処理を実行できるようユーティリティを開発した。\n * このスクリプトには原型があって、それを参考に独自のスクリプトを作成した(下記Referenceの項を参照)。\n *\n * Usage\n * const utils = new opencvUtils();\n * utils.loadOpenCV(\"https://docs.opencv.org/3.4.0/opencv.js\", () => {\n * \tutils.executeScript(\"./process.js\");\n * });\n *\n * Reference\n * https://docs.opencv.org/3.4/utils.js\n *\n * Homepage\n * https://github.com/YUUKIToriyama/opencv-utils.js\n *\n */\n\nconst opencvUtils = class {\n\tloadOpenCV(OPENCV_URL, onloadCallback) {\n\t\t/*\n\t\t * utils.loadOpenCV(url, callback);\n\t\t *\n\t\t * OpenCV.jsを読み込むための函数。\n\t\t * 以下のようなscriptタグを生成し、ドキュメントに挿入する。\n\t\t * <script async type=\"text/javascript\" src=\"OPENCV_URL\"></script>\n\t\t * さらにイベントリスナーには読み込みが完了した際、OpenCV.jsのビルド情報を出力する函数を設定している。\n\t\t *\n\t\t */\n\t\tlet script = document.createElement(\"script\");\n\t\tscript.setAttribute(\"async\", \"\");\n\t\tscript.setAttribute(\"crossOrigin\", \"true\");\n\t\tscript.setAttribute(\"type\", \"text/javascript\");\n\t\tscript.addEventListener(\"load\", () => {\n\t\t\tif (cv.getBuildInformation) {\n\t\t\t\t// opencvの読み込みが完了している場合\n\t\t\t\tconsole.log(cv.getBuildInformation());\n\t\t\t\tonloadCallback();\n\t\t\t} else {\n\t\t\t\t// opencvの読み込みを待っている場合\n\t\t\t\tcv[\"onRuntimeInitialized\"] = () => {\n\t\t\t\t\tconsole.log(cv.getBuildInformation());\n\t\t\t\t\tonloadCallback();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tscript.addEventListener(\"error\", () => {\n\t\t\tconsole.error(\"Failed to load \" + OPENCV_URL);\n\t\t});\n\t\tscript.src = OPENCV_URL;\n\t\tlet node = document.querySelector(\"head\");\n\t\tnode.appendChild(script);\n\t}\n\n\tloadImage(url, callback) {\n\t\t/*\n\t\t * utils.loadImage(url, (src) => {\n\t\t * \t\tcv.imshow(\"mycanvas\", src);\n\t\t * });\n\t\t *\n\t\t * 引数によって指定された画像を読み込みimg要素を返す函数。\n\t\t */\n\t\tlet img = new Image();\n\t\timg.crossOrigin = \"anonymous\";\n\t\timg.src = url;\n\t\timg.onload = () => {\n\t\t\tconst src = cv.imread(img, cv.IMREAD_COLOR);\n\t\t\tcallback(src);\n\t\t\tsrc.delete();\n\t\t}\n\t}\n\n\texecuteScript(url) {\n\t\t/*\n\t\t * utils.executeSctipt(url);\n\t\t *\n\t\t * 引数によって指定されたスクリプトファイルを読み出し実行する函数。\n\t\t * 実行するときはloadOpenCV()の後でなければならない。\n\t\t * あるいは次のようにloadOpenCV()のcallbackに指定しても良い。\n\t\t *\n\t\t * Util.loadOpenCV(() => {\n\t\t *\tUtil.executeScript(\"./process.js\");\n\t\t * });\n\t\t */\n\t\tconst SCRIPT_URL = url;\n\t\tlet script = document.createElement(\"script\");\n\t\tscript.setAttribute(\"type\", \"text/javascript\");\n\t\tscript.src = SCRIPT_URL;\n\t\tscript.addEventListener(\"load\", () => {\n\t\t\tconsole.log(\"Now loading \" + SCRIPT_URL);\n\t\t});\n\t\tscript.addEventListener(\"onload\", () => {\n\t\t\tconsole.log(\"Executing \" + SCRIPT_URL);\n\t\t});\n\t\tlet node = document.querySelector(\"body\");\n\t\tnode.appendChild(script);\n\t}\n\n\tstatic credit() {\n\t\tconsole.log(\"(C) Copyright 2020 YUUKIToriyama, All Rights Reserved.\");\n\t}\n}\nexport default opencvUtils;\n","/* LoadingSpinner.jsx */\n/*\n * OpenCV.jsの読み込みに時間がかかるので読み込んでいるあいだスピナーを表示します\n *\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Box, Typography, CircularProgress, Icon } from '@material-ui/core';\nimport DoneIcon from '@material-ui/icons/Done';\n\n// 自作モジュールの読み込み\nimport ScrollDialog from './ScrollDialog';\n\nclass LoadingSpinner extends React.Component {\n\trender() {\n\t\treturn (\n\t\t\t<Box>\n\t\t\t\t{!this.props.opencvLoaded ? (\n\t\t\t\t\t<CircularProgress />\n\t\t\t\t) : (\n\t\t\t\t\t<Icon color='primary' fontSize='large'>\n\t\t\t\t\t\t<DoneIcon />\n\t\t\t\t\t</Icon>\n\t\t\t\t)}\n\t\t\t\t<Typography>\n\t\t\t\t\t{!this.props.opencvLoaded\n\t\t\t\t\t\t? 'Now Loading OpenCV.js...'\n\t\t\t\t\t\t: 'OpenCV.js has been loaded on your browser!'}\n\t\t\t\t</Typography>\n\t\t\t\t{this.props.opencvLoaded == true && (\n\t\t\t\t\t<ScrollDialog\n\t\t\t\t\t\tlabel='About OpenCV.js'\n\t\t\t\t\t\ttitle='Build information'\n\t\t\t\t\t\tcontent={cv\n\t\t\t\t\t\t\t.getBuildInformation()\n\t\t\t\t\t\t\t.split('\\n')\n\t\t\t\t\t\t\t.map((line) => (\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t{line}\n\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</Box>\n\t\t);\n\t}\n}\nexport default LoadingSpinner;\n\nLoadingSpinner.propsTypes = {\n\topencvLoaded: PropTypes.bool.isRequired,\n};\nLoadingSpinner.defaultProps = {\n\topencvLoaded: false,\n};\n","/* MainContent.jsx */\nimport React from 'react';\n\n// 自作モジュールの読み込み\nimport Workflow from './Workflow';\nimport opencvUtils from '../opencv-utils/opencv-utils.js';\nimport LoadingSpinner from './LoadingSpinner';\n\nclass MainContent extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\topencvLoaded: false,\n\t\t};\n\t}\n\t// Appコンポーネントが呼び出されたら次はOpenCV.jsの読み込みを行なう\n\tcomponentDidMount() {\n\t\tconst opencv_utils = new opencvUtils();\n\t\topencv_utils.loadOpenCV('../../opencv.js', () => {\n\t\t\t// OpenCV.jsの読み込みが完了したらstate.loadingをfalseにする\n\t\t\tthis.setState({\n\t\t\t\topencvLoaded: true,\n\t\t\t});\n\t\t});\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<LoadingSpinner opencvLoaded={this.state.opencvLoaded} />\n\t\t\t\t<Workflow />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default MainContent;\n","/* App.jsx */\nimport React from 'react';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport orange from '@material-ui/core/colors/orange';\n\n// 自作モジュールの読み込み\nimport MyAppBar from './components/MyAppBar.jsx';\nimport MainContent from './components/MainContent.jsx';\n\nconst theme = createMuiTheme({\n\tpalette: {\n\t\tprimary: orange,\n\t},\n\ttypography: {\n\t\tfontFamily: ['Roboto', 'Noto Sans'].join(','),\n\t\tfontSize: 13,\n\t\th1: {\n\t\t\tfontSize: '1.75rem',\n\t\t},\n\t\th2: {\n\t\t\tfontSize: '1.5rem',\n\t\t},\n\t\th3: {\n\t\t\tfontSize: '1.25rem',\n\t\t},\n\t\th4: {\n\t\t\tfontSize: '1.125rem',\n\t\t},\n\t\th5: {\n\t\t\tfontSize: '1rem',\n\t\t},\n\t\th6: {\n\t\t\tfontSize: '1rem',\n\t\t},\n\t},\n});\n\nconst appName = 'imageCompare';\nconst appInfo = `\nimageCompare 0.9\nhttps://github.com/YUUKIToriyama/imageCompare\n(C)Copyright 2020 YUUKIToriyama All Rights Reserved.\n`;\n\nclass App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<ThemeProvider theme={theme}>\n\t\t\t\t<CssBaseline />\n\t\t\t\t<MyAppBar title={appName} message={appInfo} />\n\t\t\t\t<MainContent />\n\t\t\t</ThemeProvider>\n\t\t);\n\t}\n}\n\nexport default App;\n","/* index.js */\n\n// react\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\n\n// styleSheet\nimport \"./style.css\";\n\n// Appコンポーネントを読み込む\nimport App from \"./App.jsx\";\nReactDOM.render(<App/>, document.getElementById(\"app\"));\n"],"sourceRoot":""}