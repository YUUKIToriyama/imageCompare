(this.webpackJsonpimageCompare=this.webpackJsonpimageCompare||[]).push([[0],{85:function(e,t,n){},91:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n(0),c=n.n(i),s=n(11),r=n.n(s),o=(n(85),n(9)),l=n(10),h=n(13),u=n(12),d=n(67),j=n(134),p=n(135),m=n(66),b=n.n(m),g=function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,[{key:"loadOpenCV",value:function(e,t){var n=document.createElement("script");n.setAttribute("async",""),n.setAttribute("type","text/javascript"),n.addEventListener("load",(function(){cv.getBuildInformation?(console.log(cv.getBuildInformation()),t()):cv.onRuntimeInitialized=function(){console.log(cv.getBuildInformation()),t()}})),n.addEventListener("error",(function(){console.error("Failed to load "+e)})),n.src=e,document.querySelector("head").appendChild(n)}},{key:"loadImage",value:function(e,t){var n=new Image;n.crossOrigin="anonymous",n.src=e,n.onload=function(){var e=cv.imread(n,cv.IMREAD_COLOR);t(e),e.delete()}}},{key:"executeScript",value:function(e){var t=e,n=document.createElement("script");n.setAttribute("type","text/javascript"),n.src=t,n.addEventListener("load",(function(){console.log("Now loading "+t)})),n.addEventListener("onload",(function(){console.log("Executing "+t)})),document.querySelector("body").appendChild(n)}}],[{key:"credit",value:function(){console.log("(C) Copyright 2020 YUUKIToriyama, All Rights Reserved.")}}]),e}(),v=n(126),O=n(127),f=n(128),x=n(129),C=n(70),y=n(62),w=n.n(y),S=n(120),I=n(138),k=n(125),R=n(123),E=n(124),N=n(122),z=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleClickOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a.state={open:!1},a.descriptionElement=c.a.createRef(),a}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(S.a,{onClick:this.handleClickOpen,children:this.props.label}),Object(a.jsxs)(I.a,{open:this.state.open,onClose:this.handleClose,scroll:"paper","aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:[Object(a.jsx)(N.a,{id:"scroll-dialog-title",children:this.props.title}),Object(a.jsx)(R.a,{dividers:!0,children:Object(a.jsx)(E.a,{id:"scroll-dialog-description",ref:this.descriptionElement,tabIndex:-1,children:this.props.content})}),Object(a.jsx)(k.a,{children:Object(a.jsx)(S.a,{onClick:this.handleClose,color:"primary",children:"OK"})})]})]})}}]),n}(c.a.Component),A=Object(v.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),B="\nimageCompare 0.9\nhttps://github.com/YUUKIToriyama/imageCompare\n(C)Copyright 2020 YUUKIToriyama All Rights Reserved.\n".split("\n").map((function(e){return Object(a.jsxs)("span",{children:[e,Object(a.jsx)("br",{})]})})),L=function(){var e=A();return Object(a.jsx)("div",{className:e.root,children:Object(a.jsx)(O.a,{position:"static",children:Object(a.jsxs)(f.a,{children:[Object(a.jsx)(x.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",children:Object(a.jsx)(w.a,{})}),Object(a.jsx)(C.a,{variant:"h6",className:e.title,children:"imageCompare"}),Object(a.jsx)(z,{label:"Help",title:"About this app",content:B})]})})})},F=n(36),D=n(5),T=n(136),U=n(140),M=n(131),P=n(139),_=n(141),V=n(93),q=n(143),K=n(63),Y=n.n(K),G=(n(57),n(130)),J=n(137),W=n(16),H=n.n(W),X=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={width:0,height:0},a.mapRef=c.a.createRef(),a.layerRef=c.a.createRef(),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=new Image;return t.src=this.props.image.base64,t.onload=function(){e.setState({width:t.width,height:t.height})},Object(a.jsx)(G.a,{ref:this.mapRef,maxBounds:H.a.latLngBounds([0,0],[this.state.height,this.state.width]),center:[0,0],zoom:5,crs:H.a.CRS.Simple,style:{width:"100%",height:"300px"},children:Object(a.jsx)(J.a,{ref:this.layerRef,url:this.props.image.base64,bounds:H.a.latLngBounds([-this.state.height/2,-this.state.width/2],[this.state.height,this.state.width/2])})})}}]),n}(c.a.Component),Q=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={file1:{hoge:"hage"},file2:{}},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(a.jsxs)(T.a,{children:[Object(a.jsx)(Y.a,{labelText:"1\u679a\u3081",imagePreview:!1,multiple:!1,callbackFunction:function(t){console.log(t.name),e.setState({file1:t})},buttonComponent:Object(a.jsx)(x.a,{color:"primary","aria-label":"upload picture",component:"span",children:Object(a.jsx)(q.a,{})}),textFieldComponent:Object(a.jsx)("input",{type:"text"}),accept:"image/*"}),void 0!==this.state.file1.name?Object(a.jsx)(X,{image:this.state.file1}):""]})}}]),n}(c.a.Component),Z=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).showImage=function(e,t){(new g).loadImage(e,(function(e){cv.imshow(t,e),a.src=e.clone(),a.working=e.clone(),console.log(e.size()),a.imageSize=e.size(),a.scale=t.clientWidth/a.imageSize.width,e.delete()}))},a.drawRectifyArea=function(e){var t=new cv.Scalar(255,255,0,.5),n=new cv.Scalar(255,0,255,.5),i=a.state.vertices.length;if(i<4){var c=e.target.getBoundingClientRect(),s=(e.clientX-c.left)/a.scale,r=(e.clientY-c.top)/a.scale,o=new cv.Point(parseInt(s),parseInt(r));cv.circle(a.working,o,10/a.scale,t,cv.FILLED),cv.imshow(a.canvasElement.current,a.working),a.state.vertices.push(o),0!=i&&(cv.line(a.working,a.state.vertices[i-1],a.state.vertices[i],n,2/a.scale,cv.LINE_AA,0),cv.imshow(a.canvasElement.current,a.working))}3==i&&(cv.line(a.working,a.state.vertices[3],a.state.vertices[0],n,2/a.scale,cv.LINE_AA,0),cv.imshow(a.canvasElement.current,a.working)),4==a.state.vertices.length&&a.rectifyImage(a.src,a.state.vertices)},a.rectifyImage=function(e,t){var n=[];t.forEach((function(e){n.push(e.x),n.push(e.y)}));var i=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},c=i(t[0],t[1]),s=i(t[1],t[2]),r=i(t[2],t[3]),o=i(t[3],t[0]),l=Math.max(c,r),h=Math.max(s,o),u=[0,0,l,0,l,h,0,h],d=cv.matFromArray(4,1,cv.CV_32FC2,n),j=cv.matFromArray(4,1,cv.CV_32FC2,u),p=cv.getPerspectiveTransform(d,j),m=new cv.Mat,b=new cv.Size(l,h);cv.warpPerspective(e,m,p,b,cv.INTER_LINEAR,cv.BORDER_CONSTANT,new cv.Scalar),cv.imshow(a.canvasElement.current,m);var g={url:a.canvasElement.current.toDataURL("image/png",1,l,h),width:l,height:h};a.props.onImageProcessingDone(g),[e,m].forEach((function(e){return e.delete()}))},a.canvasElement=c.a.createRef(),a.src,a.working,a.imageSize,a.scale,a.state={vertices:[]},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.showImage(this.props.image,this.canvasElement.current)}},{key:"render",value:function(){var e=this;return Object(a.jsx)(T.a,{children:Object(a.jsx)("canvas",{onClick:function(t){return e.drawRectifyArea(t)},ref:this.canvasElement,style:{width:"500px",maxWidth:"90%"}})})}}]),n}(c.a.Component),$=n(64),ee=(H.a.icon({iconUrl:$.a,iconSize:[25,35]}),function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={lat:0,lng:0,zoom:0,crs:H.a.CRS.Simple},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.image;return Object(a.jsx)(G.a,{center:[this.state.lat,this.state.lng],zoom:this.state.zoom,crs:this.state.crs,style:{width:"100%",height:"300px"},children:Object(a.jsx)(J.a,{attribution:"imageCompare",url:e.url,bounds:H.a.latLngBounds([-e.width/2,-e.height/2],[e.width/2,e.height/2])})})}}]),n}(c.a.Component)),te=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,e)).steps=["\u753b\u50cf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9","\u9802\u70b9\u3092\u9078\u629e","\u5909\u63db"],i.handleInputImageChange=function(e){i.setState({inputImage:e})},i.handleImageProcessingDone=function(e){i.setState({processedImage:e})},i.handleNext=function(){i.setState({activeStep:i.state.activeStep+1})},i.handleBack=function(){i.setState({activeStep:i.state.activeStep-1})},i.handleReset=function(){i.setState({activeStep:0})},i.getStepContent=function(e){switch(e){case 0:return Object(a.jsxs)(T.a,{children:[Object(a.jsx)(C.a,{children:"\u51e6\u7406\u3092\u884c\u306a\u3044\u306a\u3044\u753b\u50cf\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044"}),Object(a.jsx)(Q,{onInputImageChange:i.handleInputImageChange})]});case 1:return Object(a.jsxs)(T.a,{children:[Object(a.jsx)(C.a,{children:"\u753b\u50cf\u88dc\u6b63\u306e\u305f\u3081\u306b\u9802\u70b9\u3092\u30de\u30a6\u30b9\u3067\u9078\u629e\u3057\u3066\u4e0b\u3055\u3044"}),Object(a.jsx)(Z,{image:i.state.inputImage,onImageProcessingDone:i.handleImageProcessingDone})]});case 2:return Object(a.jsxs)(T.a,{children:[Object(a.jsx)(C.a,{children:"\u51e6\u7406\u4e2d\u2026\u2026"}),Object(a.jsx)(ee,{image:i.state.processedImage})]});default:return Object(a.jsx)(C.a,{children:"Unknown step"})}},i.handleInputImageChange=i.handleInputImageChange.bind(Object(F.a)(i)),i.state={activeStep:0,inputImage:"",processedImage:{url:"",width:0,height:0}},i}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(a.jsxs)(T.a,{className:this.props.classes.root,children:[Object(a.jsx)(U.a,{activeStep:this.state.activeStep,orientation:"vertical",children:this.steps.map((function(t,n){return Object(a.jsxs)(M.a,{children:[Object(a.jsx)(P.a,{children:t}),Object(a.jsxs)(_.a,{children:[e.getStepContent(n),Object(a.jsx)(T.a,{className:e.props.classes.actionsContainer,children:Object(a.jsxs)(T.a,{children:[Object(a.jsx)(S.a,{disabled:0===e.state.activeStep,onClick:e.handleBack,className:e.props.classes.button,children:"Back"}),Object(a.jsx)(S.a,{variant:"contained",color:"primary",onClick:e.handleNext,className:e.props.classes.button,children:e.state.activeStep===e.steps.length-1?"Finish":"Next"})]})})]})]},t)}))}),this.state.activeStep===this.steps.length&&Object(a.jsxs)(V.a,{square:!0,elevation:0,className:this.props.classes.resetContainer,children:[Object(a.jsx)(C.a,{children:"\u51e6\u7406\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\uff01"}),Object(a.jsx)(S.a,{onClick:this.handleReset,className:this.props.classes.button,children:"\u3084\u308a\u76f4\u3059"})]})]})}}]),n}(c.a.Component),ne=Object(D.a)({root:{width:"100%"},button:{marginTop:"15px",marginRight:"15px"},actionsContainer:{marginBottom:"15px"},resetContainer:{padding:"15px"}})(te),ae=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={image:""},e}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsx)(ne,{})}}]),n}(c.a.Component),ie=n(132),ce=n(133),se=n(65),re=n.n(se),oe=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(T.a,{children:[this.props.loading?Object(a.jsx)(ie.a,{}):Object(a.jsx)(ce.a,{color:"primary",fontSize:"large",children:Object(a.jsx)(re.a,{})}),Object(a.jsx)(C.a,{children:this.props.loading?"Now Loading OpenCV.js...":"OpenCV.js has been loaded on your browser!"}),this.props.loading?"":Object(a.jsx)(z,{label:"About OpenCV.js",title:"Build information",content:cv.getBuildInformation().split("\n").map((function(e){return Object(a.jsxs)("span",{children:[e,Object(a.jsx)("br",{})]})}))})]})}}]),n}(c.a.Component),le=Object(d.a)({palette:{primary:b.a},typography:{fontFamily:["Roboto","Noto Sans"].join(","),fontSize:13,h1:{fontSize:"1.75rem"},h2:{fontSize:"1.5rem"},h3:{fontSize:"1.25rem"},h4:{fontSize:"1.125rem"},h5:{fontSize:"1rem"},h6:{fontSize:"1rem"}}}),he=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={loading:!0},a}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(j.a,{theme:le,children:[Object(a.jsx)(p.a,{}),Object(a.jsx)(L,{}),Object(a.jsx)(oe,{loading:this.state.loading}),Object(a.jsx)(ae,{})]})}}]),n}(c.a.Component);r.a.render(Object(a.jsx)(he,{}),document.getElementById("app"))}},[[91,1,2]]]);
//# sourceMappingURL=main.5756cd27.chunk.js.map